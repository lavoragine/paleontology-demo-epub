<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>act.march2019</title>
      <link rel="stylesheet" href="css/base.css" type="text/css"/>
      <link rel="stylesheet" href="css/style.css" type="text/css"/>
  </head>
  <body class='markdown-preview' data-use-github-style><h1 id="act-in-3-acts-an-overview-of-epub-accessibility-conformance-testing">ACT in 3 Acts: An overview of EPUB Accessibility Conformance Testing</h1>
<div class="metainfo">
<p>12 March 2019</p>
<p>Marisa DeMeglio</p>
</div>

<p>Hello! So, you wanna make an accessible EPUB - that’s awesome! Not only are you setting a great example by thoughtfully formatting the information you’re putting out into the world, you’re also reaching more markets and perhaps even complying with laws in your region.</p>
<p>This post intends to walk you through the steps in verifying that an EPUB publication is accessible (it will not really cover how you create it in the first place). We will spend some time with tools that help the process to go faster, and talk about how to make corrections based on feedback from those tools.</p>
<p>For this post, I’ve made a new sample EPUB, quickly hand-coded from the <a href="https://wikipedia.org/wiki/Paleontology">wikipedia page on Paleontology</a>. I just wanted some new content to work with, instead of the same old demo books, and also, I think if you’re a person like me who works on EPUB standards and writes EPUB-centric software, that you should also, from time to time, make an actual EPUB that’s more than a few test sentences. Will it be perfect? No. But what it is, will be accessible.</p>
<p>So, fast-forward past a lot of copy-pasting, a bit of cursing, a few moments of “why did I think this was a good idea instead of using Moby Dick,” and some light CSS tweaks; and the sample files we’re using can be found in this <a href="https://github.com/marisademeglio/paleontology-demo-epub/">github repository</a>.</p>
<p>There are different folders in the repository, each representing a version of the book in one of the steps below. Many of those versions have errors, so if you’re looking for a sample to copy, go right to <a href="https://github.com/marisademeglio/paleontology-demo-epub/tree/master/Step4.Accessible"><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Step4.Accessible</code></a>. For this blog post, we’ll start with what’s in the folder called <a href="https://github.com/marisademeglio/paleontology-demo-epub/tree/master/Step1.NotValidYet"><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Step1.NotValidYet</code></a>.</p>

<h2 id="validation">Validation</h2>
<p>Before we can start accessibility conformance testing, let’s make sure that our publication validates. This doesn’t necessarily relate to finding accessibility issues but it’s something we have to do anyway, so why not take a minute and go over it.</p>
<p>When you create an EPUB fileset, the rules for what files must be included and how they should be formatted is defined by a standard. The most current EPUB standard, as of March 2019, is version 3 (with 3.2 is on its way). Running your publication’s fileset through a validation tool will tell you if it’s compliant or if there are warnings and errors.</p>
<p>We’ll be using a free and open source tool called <a href="https://github.com/w3c/epubcheck/">EPUBCheck</a> to validate our fileset. If you’re playing along from home, you can download EPUBCheck from <a href="https://github.com/w3c/epubcheck/releases/">the releases page</a> and run it from the command line.</p>
<p>In the example below, I downloaded and unzipped the brand-new beta of EPUBCheck 4.2 into
<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">~/Downloads/epubcheck-4.2.0-beta/</code></p>
<p>Go to the directory containing the book:</p>
<p><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">$ cd ./paleontology-demo-epub/Step1.NotValidYet</code></p>
<p>Run EPUBCheck on the folder containing our EPUB:</p>
<p><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">$ java -jar ~/Downloads/epubcheck-4.2.0-beta/epubcheck.jar --mode exp .</code></p>
<p>And sit back and wait for the all-clear! Or, as it turns out, the not-at-all-clear:</p>

<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Validating using EPUB version 3.2 rules.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(OPF-004d): ..epub/EPUB/package.opf(2,142): Invalid prefix declaration: prefix 'cc' must be separated by its URI with a space.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(OPF-028): ..epub/EPUB/package.opf(13,83): Undeclared prefix: 'cc'.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(OPF-028): ..epub/EPUB/package.opf(14,89): Undeclared prefix: 'cc'.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/package.opf(20,60): Error while parsing file: value of attribute "media-type" is invalid; must be a string matching the regular expression "[a-zA-Z0-9!#$&amp;+\-\^_]+/[a-zA-Z0-9!#$&amp;+\-\^_]+.*"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/package.opf(24,92): Error while parsing file: value of attribute "media-type" is invalid; must be a string matching the regular expression "[a-zA-Z0-9!#$&amp;+\-\^_]+/[a-zA-Z0-9!#$&amp;+\-\^_]+.*"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/package.opf(28,79): Error while parsing file: value of attribute "media-type" is invalid; must be a string matching the regular expression "[a-zA-Z0-9!#$&amp;+\-\^_]+/[a-zA-Z0-9!#$&amp;+\-\^_]+.*"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(OPF-074): ..epub/EPUB/package.opf(22,94): Package resource 'EPUB/images/TREX.jpg' is declared in several manifest item.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-001): ..epub/Step1.NotValidYet.epub(-1,-1): File 'EPUB/fonts/Quicksand_Light.otf' could not be found.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-001): ..epub/Step1.NotValidYet.epub(-1,-1): File 'EPUB/fonts/Quicksand_Bold_Oblique.otf' could not be found.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/cover.xhtml(6,72): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/toc.xhtml(6,72): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="syntax--storage syntax--type syntax--class syntax--warning">WARNING</span>(RSC-017): ..epub/EPUB/xhtml/toc.xhtml(4,10): Warning while parsing file: The 'head' element should have a 'title' child element.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/intro.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p1.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p2.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p3.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p4.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p5.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/xhtml/p5.xhtml(89,15): Error while parsing file: element "dd" not allowed yet; expected the element end-tag or element "div", "dt", "script" or "template"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/xhtml/p5.xhtml(89,23): Error while parsing file: element "dd" not allowed yet; expected the element end-tag or element "div", "dt", "script" or "template"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p6.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/p7.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(CSS-010): ..epub/EPUB/xhtml/refs.xhtml(6,74): Stylesheet of type other than 'text/css' must have a fallback.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/xhtml/refs.xhtml(78,11): Error while parsing file: element "dl" not allowed here; expected the element end-tag, text, element "a", "abbr", "area", "audio", "b", "bdi", "bdo", "br", "button", "canvas", "cite", "code", "data", "datalist", "del", "dfn", "em", "embed", "i", "iframe", "img", "input", "ins", "kbd", "label", "link", "map", "mark", "meta", "meter", "ns1:switch", "ns2:math", "ns3:svg", "object", "output", "picture", "progress", "q", "ruby", "s", "samp", </span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">"script", "select", "small", "span", "strong", "sub", "sup", "template", "textarea", "time", "u", "var", "video" or "wbr" (with xmlns:ns1="<span class="syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink">http://www.idpf.org/2007/ops</span>" xmlns:ns2="<span class="syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink">http://www.w3.org/1998/Math/MathML</span>" xmlns:ns3="<span class="syntax--markup syntax--underline syntax--link syntax--http syntax--hyperlink">http://www.w3.org/2000/svg</span>") or an element from another namespace</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-005): ..epub/EPUB/xhtml/refs.xhtml(78,15): Error while parsing file: element "dd" not allowed yet; expected the element end-tag or element "div", "dt", "script" or "template"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(MED-003): ..epub/EPUB/xhtml/p3.xhtml(21,92): Non-standard image resource of type <span class="syntax--storage syntax--type syntax--class syntax--todo">TODO</span> found.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">ERROR(RSC-007): ..epub/EPUB/xhtml/refs.xhtml(159,466): Referenced resource 'EPUB/xhtml/w/index.php' could not be found in the EPUB.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="syntax--storage syntax--type syntax--class syntax--warning">WARNING</span>(OPF-003): ..epub/Step1.NotValidYet.epub(-1,-1): Item 'EPUB/fonts/TruenoBd.otf' exists in the EPUB, but is not declared in the OPF manifest.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="syntax--storage syntax--type syntax--class syntax--warning">WARNING</span>(OPF-003): ..epub/Step1.NotValidYet.epub(-1,-1): Item 'EPUB/fonts/TruenoLt.otf' exists in the EPUB, but is not declared in the OPF manifest.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="syntax--storage syntax--type syntax--class syntax--warning">WARNING</span>(OPF-003): ..epub/Step1NotValidYet.epub(-1,-1): Item 'EPUB/fonts/TruenoLtIt.otf' exists in the EPUB, but is not declared in the OPF manifest.</span></span></div><div class="line"></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Check finished with errors</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Messages: 0 fatal / 26 errors / 4 warnings / 0 info</span></span></div><div class="line"></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">EPUBCheck completed</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">$</span></span></div></pre><p>Well that output looks a bit scary. But let’s take a closer look. In this case, there are a lot of errors in the package document, and a few stray markup errors elsewhere. Many look like typos and things I forgot (e.g. <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">media-type=”TODO”</code>). Rather than go over each and every error, I’m going to tell you that I fixed the problems in the package document first, referencing the <a href="https://w3c.github.io/publ-epub-revision/epub32/spec/epub-spec.html">EPUB specification</a>  when I needed clarity on the rules. This cleared up a lot of other errors throughout; and was left with just a handful of easily resolved markup issues. E.g.</p>
<p>As far as I can tell, this was an attempt to quote some text, but the markup had errors when ported from wikipedia to an XHTML context. (EPUB 3’s text files are XHTML, which is stricter than your average HTML web page):</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;dl&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">  </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;dd&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;dl&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">      </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;dd&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">      </span>"the number of distinct genera alive at any given time; that is, those whose first occurrence predates and whose last occurrence postdates that time"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">        </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;sup id="cite_ref-RohdeMuller2005_97-0" class="reference"&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">          </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;a href="refs.xhtml#cite_note-RohdeMuller2005-97"&gt;&amp;#91;97&amp;#93;&lt;/a&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">        </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/sup&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">      </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/dd&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/dl&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">  </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/dd&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;/dl&gt;</span></span></div></pre><p>So, I replaced it with this, which works just as well:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;blockquote&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">  </span><span class="syntax--meta syntax--paragraph syntax--text">"the number of distinct genera alive at any given time; that is, those whose first occurrence predates and whose last occurrence postdates that time"</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">  </span>&lt;sup id="cite_ref-RohdeMuller2005_97-0" class="reference"&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">      </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;a href="refs.xhtml#cite_note-RohdeMuller2005-97"&gt;&amp;#91;97&amp;#93;&lt;/a&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">  </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/sup&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;/blockquote&gt;</span></span></div></pre><p>There were one or two other cases like the above example, and that bit of editing was all that was required. The corrected files are in the <a href="https://github.com/marisademeglio/paleontology-demo-epub/tree/master/Step2.NotAccessibleYet"><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Step2.NotAccessibleYet</code></a> folder. So let’s go to that folder and check again:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">$cd ../Step2.NotAccessibleYet</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">$ java -jar ~/Downloads/epubcheck-4.2.0-beta/epubcheck.jar --mode exp .</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Validating using EPUB version 3.2 rules.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">No errors or warnings detected.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Messages: 0 fatal / 0 errors / 0 warnings / 0 info</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">EPUBCheck completed</span></span></div></pre><p>Great, so now our book is valid EPUB 3.2!</p>
<h2 id="automated-testing">Automated testing</h2>
<p>Now we can start testing our newly-validated EPUB for accessibility. The first step is to run it through an automated checker.</p>
<p>The first thing to know about automated accessibility testing is that it covers around <a href="https://www.deque.com/blog/accessibility-testing-axe-webdriverjs/#post-15746">30% of the total task of accessibility checking</a>. The rest has to be done manually, but don’t worry, there are tools to help with that too.</p>
<p>We’re going to use <a href="https://daisy.github.io/ace/">Ace by DAISY</a> to do our automated checking. [Full disclosure, Romain and I are both developers of Ace.] Ace is free and open source, and you can install it by following <a href="https://daisy.github.io/ace/getting-started/installation/">these instructions</a>.</p>
<p>Hang on, that’s the command line version. It generates the same report, so it would be just fine. But I’m going to show the GUI version, newly developed, and with a public beta coming soon. If you were feeling intrepid, you could check out the project from <a href="https://github.com/daisy/ace-gui">github</a> and build it yourself, and while it’s a few issues shy of release, it works quite well.</p>
<p>You just drop your EPUB folder or file on the logo (or sidebar)! And then it spins and thinks a bit…</p>
<p><img alt="Ace running its checks" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-running.png"></p>
<p>And then you get a report about your EPUB, organized into five tabs: summary, violations, metadata, outlines, and images:</p>
<p><img alt="Ace report" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-report-errors.png"></p>
<p>We’re going to look at the “Violations” tab, which shows a table where each row represents an violation found in the book. The rows can be filtered by several properties, such as the rule that triggered the violation, or the file in which it was found.</p>
<p><img alt="Ace violations tab" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-violations.png"></p>
<p>I see that our book has a lot of missing <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">alt</code> attributes, some missing metadata, a few minor things, and one case of an empty <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">title</code> element, which EPUBCheck didn’t care about (it cares that there is a <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">title</code> element, but not what it contains).</p>
<p>The rightmost column in the table describes possible causes for each violation, and includes a link where you can learn more about that topic. This link will take you to the relevant page in the <a href="http://kb.daisy.org/">DAISY Accessible Publishing Knowledge Base</a>, where you’ll find a topic overview, techniques, and examples.</p>
<p>First, I’ll tackle the images. In addition to the Accessible Publishing KB, I’m going to reference <a href="http://diagramcenter.org/59-image-guidelines-for-epub-3.html">The DIAGRAM Center</a> for guidance. Ace’s “Images” tab shows all the images in the EPUB, along with their <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">alt</code> text, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">aria-described-by</code> content, and associated <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">figcaption</code>, so this is a quick way to see what needs attention.</p>
<p><img alt="Ace images tab" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-images-1.png"></p>
<p>With my text editor open, I noticed that I had created <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">aside</code> elements for each image and caption, just treating them as generic secondary content:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;aside&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">  </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;img src="../images/TREX.jpg" width="150" height="100"/&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">  </span>&lt;p&gt;Analyses using &lt;a href="<span class="syntax--markup syntax--underline syntax--link syntax--https syntax--hyperlink">https://wikipedia.org/wiki/Engineering</span>" title="Engineering"&gt;engineering&lt;/a&gt; techniques show that &lt;i&gt;&lt;a href="<span class="syntax--markup syntax--underline syntax--link syntax--https syntax--hyperlink">https://wikipedia.org/wiki/Tyrannosaurus</span>" title="Tyrannosaurus"&gt;Tyrannosaurus&lt;/a&gt;&lt;/i&gt; had a devastating bite, but raise doubts about how fast it could move.&lt;/p&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;/aside&gt;</span></span></div></pre><p>but really, a <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">figure</code> would be more semantically appropriate. So while the old markup could have been made accessible by editing the <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">alt</code> attribute, I decided to also reformat things a bit (including corresponding changes in the CSS):</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;figure&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;img alt=”T. Rex skull” src="../images/TREX.jpg" width="150" height="100"/&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">    </span>&lt;figcaption&gt;Analyses using &lt;a href="<span class="syntax--markup syntax--underline syntax--link syntax--https syntax--hyperlink">https://wikipedia.org/wiki/Engineering</span>" title="Engineering"&gt;engineering&lt;/a&gt; techniques show that &lt;i&gt;&lt;a href="<span class="syntax--markup syntax--underline syntax--link syntax--https syntax--hyperlink">https://wikipedia.org/wiki/Tyrannosaurus</span>" title="Tyrannosaurus"&gt;Tyrannosaurus&lt;/a&gt;&lt;/i&gt; had a devastating bite, but raise doubts about how fast it could move.&lt;/figcaption&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;/figure&gt;</span></span></div></pre><p>All the images should be sorted out now. If I wanted, I could re-run Ace to check again.</p>
<p>The next thing to look at is metadata. Ace reported some violations related to metadata; in addition, the “Metadata” tab shows me which accessibility metadata is missing.</p>
<p>Note that here, “Missing” does not mean “Must have”; it just means that it’s not there.</p>
<p>Not all accessibility metadata is required, but it’s good to use as much as is relevant to your publication. I’ll use the <a href="http://www.idpf.org/epub/a11y/accessibility.html">EPUB Accessibility 1.0  Specification</a> as a reference for the metadata requirements.</p>
<p>As a result, I added the following to the package document:</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessMode"&gt;textual, visual&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;alternativeText&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">    </span>&lt;meta property="schema:accessibilityHazard"&gt;none&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">    </span>&lt;meta property="schema:accessibilitySummary"&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">     </span><span class="syntax--meta syntax--paragraph syntax--text">The publication has been partially evaluated for accessibility.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span class="leading-whitespace">    </span>&lt;meta property="schema:accessModeSufficient"&gt;textual&lt;/meta&gt;</span></span></div></pre><p>So, now I’ve addressed all the issues reported by Ace. I’m going to re-run both EPUBCheck and Ace to make sure we're good to go.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">$ cd ../Step3.AutomatedChecksDone</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">$ java -jar ~/Downloads/epubcheck-4.2.0-beta/epubcheck.jar --mode exp .</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Validating using EPUB version 3.2 rules.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">No errors or warnings detected.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">Messages: 0 fatal / 0 errors / 0 warnings / 0 info</span></span></div></pre><p><img alt="Ace showing zero violations" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-inbox-zero.png"></p>
<p>This is exciting! No errors and no accessibility violations. These tools really should show a little celebratory animation or something. Someone should tell the developers…</p>
<p>The corrected files have been saved under <a href="https://github.com/marisademeglio/paleontology-demo-epub/tree/master/Step3.AutomatedChecksDone"><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Step3.AutomatedChecksDone</code></a>, which is what we’ll start the next section with.</p>
<p>I also want to save my Ace report, so go under the File menu and choose “Export Report”. This gives me a zipfile containing two versions of the report: the raw JSON data, and the more visually-appealing HTML version. Unzip the archive and have <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">report.json</code> ready for the next part.</p>
<h2 id="manual-testing">Manual testing</h2>
<p>Our EPUB is in pretty good shape at this point - we’ve fixed all the problems that automated tools could find. Take a break and celebrate!</p>
<p>Ok, not so fast. This book isn’t accessible yet. As you might imagine, it’s not possible at this point in history for a computer to tell you if your image description is accurate or your pages are arranged in a meaningful sequence. That’s where manual testing comes into play.</p>
<p>Manual testing can be the most tedious and overlooked part of accessibility testing, but we can use a tool called SMART to lighten the load significantly. It picks up where Ace left off.</p>
<p>SMART is a web-based tool. Go to the <a href="https://smart.daisy.org">SMART homepage</a> and click “sign up” to try it out:
<img alt="SMART homepage" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/smart-homepage.png"></p>
<p>Drag and drop the <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">report.json</code> file saved from Ace into SMART. This tells it about the different features of your book, and SMART intelligently filters a series of checkpoints based on your content. For example, there’s no point in spending time on audio or video checkpoints if your book contains neither.</p>
<p>You might be wondering where these checkpoints come from -  if you look at the <a href="http://www.idpf.org/epub/a11y/accessibility.html">EPUB Accessibility specification</a>, you’ll get an idea. They include things like checks that come from WCAG, for example, regarding images; and EPUB-specific topics such as checking that your spine is arranged logically.</p>
<p>So, let’s go through the checkpoints and see how our book looks. We won’t go over every single checkpoint together, but the examples below should give you a good idea of what SMART does.</p>
<p>I’m going to keep my Ace “images” tab open while i skim the images list, while I verify what SMART is asking about how I use <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">alt</code> and <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">figcaption</code>.</p>
<p><img alt="Ace images" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-images-2.png"></p>
<p>Oh hang on, what’s that T. Rex on the cover have? <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">alt=“It’s an image”</code>? Let’s fix that so it’s a little more useful.</p>
<p>After reviewing the images, I move on to the content structure, making sure the order looks good and the headings are in order. I can use Ace’s outlines tab for a high-level overview:</p>
<p><img alt="Ace outlines tab" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/ace-outlines.png"></p>
<p>Then, back in SMART, I can sign off on those checkpoints by marking them as “Pass”, and continue along through the checkpoints. I notice that many are grayed-out because they are about topics not relevant to my publication (e.g. video captioning).</p>
<p>I notice under “contrast”, SMART notes that if I haven’t run Ace, I need to go over this section manually, without a doubt. However, I ran Ace, which would have let me know if I was failing contrast minimums, so I feel pretty good about this part too.</p>
<p>Next, SMART helped me generate some better metadata than what I had added previously. I hadn’t been as thorough as I could have been.</p>
<pre class="editor-colors lang-text"><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;alternativeText&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;captions&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;readingOrder&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;structuralNavigation&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityFeature"&gt;tableOfContents&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilitySummary"&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">     </span><span class="syntax--meta syntax--paragraph syntax--text">The publication has been evaluated for accessibility.</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="leading-whitespace">    </span><span class="syntax--meta syntax--paragraph syntax--text">&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityHazard"&gt;none&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessMode"&gt;textual&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessMode"&gt;visual&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessModeSufficient"&gt;textual&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityControl"&gt;fullKeyboardControl&lt;/meta&gt;</span></span></div><div class="line"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text">&lt;meta property="schema:accessibilityControl"&gt;fullMouseControl&lt;/meta&gt;</span></span></div></pre><p><img alt="SMART metadata generator" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/smart-metadata.png"></p>
<p>Proceeding through the rest of SMART’s prompts and checkpoints gives me a chance to create metadata for an ONIX record and also certify this publication as accessible. SMART ends by generating a report, summarizing your publication’s accessibility:</p>
<p><img alt="SMART report" src="/Users/marisa/dev/paleontology-demo-epub/blog/images/smart-report.png"></p>
<p>Reminder to run EPUBCheck again if you've edited your files at all since the last time we ran it.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I still see room for improvement, so I hope one day I can continue this post by experimenting with some of the charts from the original article that were left out here. There was a lot of really weird markup on these, so making them accessible is definitely an interesting challenge.</p>
<p>Even with the relatively simple text I prepared for this example, I saved a lot of time by using tools to help me do accessibility testing. They considerably reduced the tedium by providing automated analysis and guided manual checks; and they also gave appropriate reference information about important concepts along the way.</p>
<p>The goal of this post was to show the steps of accessibility conformance testing for EPUBs, using currently-available resources. The tools used here are actively being further developed and will continue to benefit from your support and involvement.</p>
<p>Thanks to <a href="twitter.com/rdeltour">Romain Deltour</a> for his help editing this post.</p>
<h1 id="resources">Resources</h1>
<ul>
<li><a href="https://github.com/marisademeglio/paleontology-demo-epub/">Sample files used here</a></li>
<li><a href="https://github.com/w3c/epubcheck">EPUBCheck</a></li>
<li><a href="https://github.io/daisy/ace">Ace by DAISY</a></li>
<li><a href="https://smart.daisy.org">SMART</a></li>
<li><a href="https://w3c.github.io/publ-epub-revision/epub32/spec/epub-spec.html">EPUB 3.2 draft specification</a></li>
<li><a href="http://www.idpf.org/epub/a11y/accessibility.html">EPUB Accessibility 1.0 specification</a></li>
<li><a href="https://kb.daisy.org">DAISY Accessible Publishing KB</a></li>
<li><a href="http://diagramcenter.org/59-image-guidelines-for-epub-3.html">DIAGRAM Center image description guidelines</a></li>
</ul></body>
</html>
